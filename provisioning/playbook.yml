---
- hosts: all
  sudo: yes

  roles:
    - docker
    - openshift-origin-next

  tasks:
    - name: "Build /etc/hosts on all hosts"
      lineinfile: dest=/etc/hosts
                  regexp='.*{{ item }}$' line="{{ hostvars[item].ansible_default_ipv4.address }} {{ item }}"
                  state=present
      when: hostvars[item].ansible_default_ipv4.address is defined
      with_items: groups['all']

- hosts: masters
  sudo: yes
  roles:
    - etcd
    - flannel
    - master

- hosts: minions
  sudo: yes
  roles:
    - flannel
    - minion 
